---
// import { undefined } from 'astro:schema';
import ArticleCard from '../../../components/ArticleCard.astro';
import MainLayout from './../../../layouts/MainLayout.astro'
import './../../../styles/index.css'
import { capitalize } from '../../../utils';

import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';

const {tag} = Astro.params

if (tag === undefined) {
    throw new Error('Tag is required')
}

const allBlogArticles: CollectionEntry<'blog'>[] = (await getCollection('blog')).sort((a:CollectionEntry<'blog'>,b:CollectionEntry<'blog'>)=> b.data.pubDate.valueOf()- a.data.pubDate.valueOf())

const tagArticles  = allBlogArticles.filter(article => article.data.tags.includes(tag))
---
<MainLayout title="Blog">
	
    <div class="tags-page">
        <a href="/blog" class="back"> Retour aux po√®mes </a>
        <div class="title">
            <h1>#{capitalize(tag)}</h1>
        </div>
          
        <div class="articles-cards-container">
            {tagArticles.map((article)=>(
                <ArticleCard article={article}/>
            ))}
        </div>
    </div>
</MainLayout>